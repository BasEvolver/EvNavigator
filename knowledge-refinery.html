<!-- knowledge-refinery.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigator - Knowledge Refinery</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="js/auth.js"></script>
    <script>
  // Prevents sidebar flicker on page load
  (function() {
    try {
      if (localStorage.getItem('sidebarCollapsed') === 'true') {
        document.documentElement.classList.add('sidebar-collapsed-preload');
      }
    } catch (e) {
      console.error('Could not apply sidebar preload state.', e);
    }
  })();
</script>
</head>
<body>
    <div class="app-container">
        <div id="sidebar-container"></div>
        <div class="main-content-wrapper">
            <div id="header-container"></div>
            <main id="main-content" class="p-6 sm:p-8 flex flex-col">
                <div class="knowledge-refinery-layout">
                    <div id="refinery-pane-1" class="refinery-pane"></div>
                    <div id="refinery-pane-2" class="refinery-pane"></div>
                    <div id="refinery-pane-3" class="refinery-pane"></div>
                </div>
            </main>
        </div>
    </div>

    <div id="file-selection-modal" class="feedback-modal-overlay" style="display: none;">
        <div class="ingestion-modal-content">
            <div class="ingestion-modal-header">
                <div>
                    <h4 class="feedback-modal-title">Knowledge Ingestion Queue</h4>
                    <p class="feedback-modal-text">Select a new document to process and add to the knowledge base.</p>
                </div>
                <button data-action="close-modal" class="close-btn">Ã—</button>
            </div>
            <div class="ingestion-modal-controls">
                <input type="search" id="ingestion-search-input" placeholder="Search documents by name or description..." class="ingestion-search-bar" />
                <select id="ingestion-source-filter" class="ingestion-filter">
                    <option value="all">Source: All</option>
                    <option value="Data Room">Data Room</option>
                    <option value="Repository Upload">Repository Upload</option>
                    <option value="Email Ingestion">Email Ingestion</option>
                    <option value="Chat Upload">Chat Upload</option>
                </select>
            </div>
            <div id="ingestion-file-list" class="ingestion-file-list"></div>
            <div class="feedback-modal-actions">
                <button data-action="close-modal" class="secondary-button">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ADDED: Confirmation Modal -->
    <div id="confirmation-modal" class="feedback-modal-overlay" style="display: none;">
        <div class="confirmation-modal-content">
            <div class="confirmation-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
            </div>
            <h4 class="feedback-modal-title">Success</h4>
            <p class="feedback-modal-text">The document has been normalized, interpreted, and committed to the Knowledge Base. It is now available for ARIA to use in analysis.</p>
            <div class="feedback-modal-actions">
                <button data-action="close-confirmation" class="primary-button">Done</button>
            </div>
        </div>
    </div>

    <script src="js/data.js"></script>
    <script src="js/MaturityModel.js"></script>
    <script src="js/state.js"></script>
    <script src="js/shared.js"></script>
    <script src="js/refinery-artifacts.js"></script> <!-- ADDED THIS SCRIPT -->
    <script src="js/knowledge-refinery.js"></script>
</body>
</html>